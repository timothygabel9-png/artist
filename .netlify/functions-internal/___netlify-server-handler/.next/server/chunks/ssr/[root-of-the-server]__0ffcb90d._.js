module.exports=[18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},24361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},14747,(a,b,c)=>{b.exports=a.x("path",()=>require("path"))},56436,a=>{"use strict";a.i(60121);var b=a.i(5420),c=a.i(20237);async function d(a,d){let e=(0,b.ref)(c.storage,d);return await (0,b.uploadBytes)(e,a,{contentType:a.type}),await (0,b.getDownloadURL)(e)}a.s(["uploadFile",()=>d])},90753,a=>{"use strict";a.i(69387);var b=a.i(60574),c=a.i(20237);async function d(a){let d=await (0,b.getDoc)((0,b.doc)(c.db,"users",a));return d.exists()&&d.data()?.role==="admin"}a.s(["isAdmin",()=>d])},49436,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(30485);var d=a.i(31052);a.i(69387);var e=a.i(60574),f=a.i(20237),g=a.i(90753),h=a.i(56436),i=a.i(38246);function j(){let[a,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)("mural"),[s,t]=(0,c.useState)("outdoor"),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(0),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(""),G=(0,c.useMemo)(()=>w.split(",").map(a=>a.trim()).filter(Boolean),[w]);async function H(a){if(a.preventDefault(),F(""),!k||!m)return void F("Not authorized.");if(!o.trim())return void F("Title is required.");if(0===y.length)return void F("Please add at least one image.");if(A<0||A>=y.length)return void F("Cover image selection is invalid.");D(!0);try{let a=(await (0,e.addDoc)((0,e.collection)(f.db,"portfolioItems"),{title:o.trim(),type:q,category:s,description:u.trim(),tags:G,featured:!1,coverImageUrl:"",imageUrls:[],createdAt:(0,e.serverTimestamp)(),updatedAt:(0,e.serverTimestamp)()})).id,b=[];for(let c=0;c<y.length;c++){let d=y[c],e=d.name.replace(/[^\w.\-]+/g,"_"),f=`portfolio/${a}/${Date.now()}_${c}_${e}`,g=await (0,h.uploadFile)(d,f);b.push(g),F(`Uploaded ${c+1}/${y.length}...`)}let c=b[A];await (0,e.updateDoc)((0,e.doc)(f.db,"portfolioItems",a),{imageUrls:b,coverImageUrl:c,updatedAt:(0,e.serverTimestamp)()}),F("âœ… Portfolio item created!"),p(""),v(""),x(""),z([]),B(0)}catch(a){console.error("UPLOAD ERROR:",a),F(a?.code?`${a.code}: ${a.message||"Upload failed."}`:a?.message||"Upload failed.")}finally{D(!1)}}return(0,c.useEffect)(()=>{let a=(0,d.onAuthStateChanged)(f.auth,async a=>{if(j(!0),!a){n(null),l(!1);return}n(a.uid),l(await (0,g.isAdmin)(a.uid))});return()=>a()},[]),a?m?k?(0,b.jsxs)("div",{className:"min-h-screen p-6 max-w-3xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold",children:"Portfolio Upload"}),(0,b.jsx)(i.default,{className:"underline",href:"/admin",children:"Admin Home"})]}),(0,b.jsxs)("form",{onSubmit:H,className:"mt-6 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm mb-1",children:"Title"}),(0,b.jsx)("input",{className:"w-full border rounded p-2",value:o,onChange:a=>p(a.target.value)})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm mb-1",children:"Type"}),(0,b.jsxs)("select",{className:"w-full border rounded p-2",value:q,onChange:a=>r(a.target.value),children:[(0,b.jsx)("option",{value:"mural",children:"Mural"}),(0,b.jsx)("option",{value:"carpentry",children:"Carpentry"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm mb-1",children:"Category"}),(0,b.jsxs)("select",{className:"w-full border rounded p-2",value:s,onChange:a=>t(a.target.value),children:[(0,b.jsx)("option",{value:"outdoor",children:"Outdoor"}),(0,b.jsx)("option",{value:"indoor",children:"Indoor"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm mb-1",children:"Description"}),(0,b.jsx)("textarea",{className:"w-full border rounded p-2 min-h-[120px]",value:u,onChange:a=>v(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm mb-1",children:"Tags (comma-separated)"}),(0,b.jsx)("input",{className:"w-full border rounded p-2",value:w,onChange:a=>x(a.target.value),placeholder:"bright, animals, downtown"})]}),(0,b.jsxs)("div",{className:"border rounded p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:"Images"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Add multiple images. Pick which one is the cover."})]}),(0,b.jsxs)("label",{className:"px-4 py-2 rounded bg-black text-white cursor-pointer",children:["Add Images",(0,b.jsx)("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:a=>(function(a){if(!a)return;let b=Array.from(a);z(a=>[...a,...b])})(a.target.files)})]})]}),y.length>0&&(0,b.jsx)("div",{className:"mt-4 space-y-2",children:y.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 border rounded p-2",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("p",{className:"truncate",children:a.name}),(0,b.jsxs)("p",{className:"text-xs text-gray-600",children:[Math.round(a.size/1024)," KB"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("label",{className:"text-sm flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"radio",name:"cover",checked:A===c,onChange:()=>B(c)}),"Cover"]}),(0,b.jsx)("button",{type:"button",className:"px-3 py-1 rounded border",onClick:()=>{z(a=>a.filter((a,b)=>b!==c)),A===c&&B(0),A>c&&B(a=>a-1)},children:"Remove"})]})]},c))})]}),(0,b.jsx)("button",{type:"submit",disabled:C,className:"px-4 py-2 rounded bg-black text-white disabled:opacity-60",children:C?"Uploading...":"Create Portfolio Item"}),E&&(0,b.jsx)("p",{className:"text-sm mt-2",children:E})]})]}):(0,b.jsxs)("div",{className:"p-6 max-w-2xl mx-auto",children:[(0,b.jsx)("p",{className:"text-red-700",children:"This account is not an admin."}),(0,b.jsxs)("p",{className:"text-sm mt-2",children:["Fix: in Firestore create ",(0,b.jsxs)("code",{children:["users/",m]})," with ",(0,b.jsx)("code",{children:'role: "admin"'}),"."]}),(0,b.jsx)(i.default,{className:"underline",href:"/admin",children:"Back"})]}):(0,b.jsxs)("div",{className:"p-6 max-w-2xl mx-auto",children:[(0,b.jsx)("p",{children:"You are not signed in."}),(0,b.jsx)(i.default,{className:"underline",href:"/admin",children:"Go to Admin Login"})]}):(0,b.jsx)("div",{className:"p-6",children:"Loading..."})}a.s(["default",()=>j])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__0ffcb90d._.js.map