module.exports=[18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},24361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},14747,(a,b,c)=>{b.exports=a.x("path",()=>require("path"))},90753,a=>{"use strict";a.i(69387);var b=a.i(60574),c=a.i(20237);async function d(a){let d=await (0,b.getDoc)((0,b.doc)(c.db,"users",a));return d.exists()&&d.data()?.role==="admin"}a.s(["isAdmin",()=>d])},56436,a=>{"use strict";a.i(60121);var b=a.i(5420),c=a.i(20237);async function d(a,d){let e=(0,b.ref)(c.storage,d);return await (0,b.uploadBytes)(e,a,{contentType:a.type}),await (0,b.getDownloadURL)(e)}a.s(["uploadFile",()=>d])},23119,a=>{"use strict";var b=a.i(87924),c=a.i(38246),d=a.i(72131);a.i(30485);var e=a.i(31052);a.i(69387);var f=a.i(60574),g=a.i(20237),h=a.i(90753),i=a.i(56436);function j(){let[a,j]=(0,d.useState)(!1),[k,l]=(0,d.useState)(!1),[m,n]=(0,d.useState)(null),[o,p]=(0,d.useState)("audio"),[q,r]=(0,d.useState)(""),[s,t]=(0,d.useState)(""),[u,v]=(0,d.useState)(null),[w,x]=(0,d.useState)(!1),[y,z]=(0,d.useState)("");(0,d.useEffect)(()=>{let a=(0,e.onAuthStateChanged)(g.auth,async a=>{if(j(!0),!a){n(null),l(!1);return}n(a.uid),l(await (0,h.isAdmin)(a.uid))});return()=>a()},[]);let A=(0,d.useMemo)(()=>{let a=s.trim();if(!a)return"";let b=a.match(/[?&]v=([^&]+)/);if(b?.[1])return b[1];let c=a.match(/youtu\.be\/([^?&]+)/);return c?.[1]?c[1]:a},[s]);async function B(a){if(a.preventDefault(),z(""),!k||!m)return void z("Not authorized.");if("audio"===o){if(!u)return void z("Please choose an audio file first.");if(!q.trim())return void z("Title is required.")}else{if(!q.trim())return void z("Title is required.");if(!A)return void z("Please paste a YouTube URL or ID.")}x(!0);try{if("youtube"===o){await (0,f.addDoc)((0,f.collection)(g.db,"mediaItems"),{type:"youtube",title:q.trim(),youtubeId:A,createdAt:(0,f.serverTimestamp)(),updatedAt:(0,f.serverTimestamp)()}),z("✅ YouTube media item created!"),r(""),t("");return}let a=(await (0,f.addDoc)((0,f.collection)(g.db,"mediaItems"),{type:"audio",title:q.trim(),audioUrl:"",createdAt:(0,f.serverTimestamp)(),updatedAt:(0,f.serverTimestamp)()})).id,b=u.name.replace(/[^\w.\-]+/g,"_"),c=`media/${a}/${Date.now()}_${b}`;z("Uploading audio…");let d=await (0,i.uploadFile)(u,c);await (0,f.updateDoc)((0,f.doc)(g.db,"mediaItems",a),{audioUrl:d,updatedAt:(0,f.serverTimestamp)()}),z("✅ Audio media item created!"),r(""),v(null)}catch(a){console.error("ADMIN MEDIA ERROR:",a),z(a?.code?`${a.code}: ${a.message||"Failed."}`:a?.message||"Failed.")}finally{x(!1)}}return a?m?k?(0,b.jsxs)("main",{className:"min-h-screen p-6 max-w-3xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h1",{className:"text-2xl font-semibold",children:"Admin • Media"}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(c.default,{className:"underline",href:"/media",children:"View Media"}),(0,b.jsx)(c.default,{className:"underline",href:"/admin",children:"Admin Home"})]})]}),(0,b.jsxs)("form",{onSubmit:B,className:"mt-6 space-y-4",children:[(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>p("audio"),className:`px-4 py-2 rounded border ${"audio"===o?"bg-black text-white":"bg-white"}`,children:"Upload Audio"}),(0,b.jsx)("button",{type:"button",onClick:()=>p("youtube"),className:`px-4 py-2 rounded border ${"youtube"===o?"bg-black text-white":"bg-white"}`,children:"Add YouTube"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm mb-1",children:"Title"}),(0,b.jsx)("input",{className:"w-full border rounded p-2",value:q,onChange:a=>r(a.target.value),placeholder:"audio"===o?"Demo Track":"Studio Session"})]}),"youtube"===o?(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm mb-1",children:"YouTube URL or ID"}),(0,b.jsx)("input",{className:"w-full border rounded p-2",value:s,onChange:a=>t(a.target.value),placeholder:"https://www.youtube.com/watch?v=Th6MgtypAew or Th6MgtypAew"}),A?(0,b.jsxs)("p",{className:"text-xs text-gray-600 mt-2",children:["Detected ID: ",A]}):null]}):(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm mb-2",children:"Audio file (mp3/wav)"}),(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,b.jsxs)("label",{className:"inline-block cursor-pointer rounded-md bg-black px-4 py-2 text-sm font-semibold text-white hover:bg-black/90",children:["Browse Audio",(0,b.jsx)("input",{type:"file",accept:"audio/*",className:"hidden",onChange:a=>v(a.target.files?.[0]||null)})]}),u?(0,b.jsx)("button",{type:"button",className:"rounded-md border px-3 py-2 text-sm hover:bg-black/5",onClick:()=>v(null),children:"Remove"}):null]}),u?(0,b.jsxs)("p",{className:"text-xs text-gray-600 mt-2",children:["Selected: ",u.name," (",Math.round(u.size/1024)," KB)"]}):(0,b.jsx)("p",{className:"text-xs text-gray-600 mt-2",children:"No file chosen."})]}),(0,b.jsx)("button",{type:"submit",disabled:w,className:"px-4 py-2 rounded bg-black text-white disabled:opacity-60",children:w?"Saving…":"audio"===o?"Create Audio Item":"Create YouTube Item"}),y&&(0,b.jsx)("p",{className:"text-sm mt-2",children:y})]})]}):(0,b.jsxs)("div",{className:"p-6 max-w-2xl mx-auto",children:[(0,b.jsx)("p",{className:"text-red-700",children:"This account is not an admin."}),(0,b.jsxs)("p",{className:"text-sm mt-2",children:["Fix: Firestore doc ",(0,b.jsxs)("code",{children:["users/",m]})," with ",(0,b.jsx)("code",{children:'role: "admin"'}),"."]}),(0,b.jsx)(c.default,{className:"underline",href:"/admin",children:"Back"})]}):(0,b.jsxs)("div",{className:"p-6 max-w-2xl mx-auto",children:[(0,b.jsx)("p",{children:"You are not signed in."}),(0,b.jsx)(c.default,{className:"underline",href:"/admin",children:"Go to Admin Login"})]}):(0,b.jsx)("div",{className:"p-6",children:"Loading…"})}a.s(["default",()=>j])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__0c73a2e0._.js.map